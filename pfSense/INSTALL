1. Настройте сетевой доступ к pfSense и включите SSH (System ➜ Advanced ➜ Enable Secure Shell).
2. Через веб-интерфейс http://host выполните проверку обновлений и установите критические патчи, если они доступны.
3. Скопируйте содержимое текущей директории `pfSense` на удалённый хост в корень:
   ```sh
   scp -r ./ root@host:/
   ```
4. Подключитесь к удалённому хосту и установите обязательные пакеты:
   ```sh
    ssh user@host 
    pkg install -y xmlstarlet
    et PKG = `pkg search -x frr |  awk '/pfSense/{print $1}'`
    echo y | pkg install "$PKG"
    ```
5. Добавьте ранний запуск скриптов в `config.xml` (команда создаст узел, если его ещё нет):
   ```sh
   ssh user@host "xml ed -L -u '//system/earlyshellcmd' -v '/etc/context.d/ResizeZfs onestart && /etc/context.d/ContextOnly onestart' /cf/conf/config.xml || \
                  xml ed -L -a '//system' -t elem -n earlyshellcmd -v '/etc/context.d/ResizeZfs onestart && /etc/context.d/ContextOnly onestart' /cf/conf/config.xml"
   ```
6. Очистите логи и резервные копии:
    ```sh
    ssh user@host "find /var/log -type f -exec rm -f {} +"
   ssh user@host "rm -f /cf/conf/backup/*"
    ```
7. Перезагрузите pfSense, чтобы запустился новый цикл инициализации:
   ```sh
   ssh user@host 'reboot'
   ```
